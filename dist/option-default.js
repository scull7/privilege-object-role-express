// Generated by CoffeeScript 1.10.0
(function() {
  var _validateContext, addRoles, getContext;

  _validateContext = function(ctx) {
    var errMsg;
    errMsg = (function() {
      switch (false) {
        case !!ctx:
          return 'request_not_valid';
        case !!ctx.user:
          return 'user_not_found';
        case !!ctx.user.roles:
          return 'user_roles_not_found';
        default:
          return null;
      }
    })();
    if (errMsg) {
      return new TypeError(errMsg);
    } else {
      return null;
    }
  };

  getContext = function(req, done) {
    var err;
    err = _validateContext(req);
    if (err) {
      return done(err);
    } else {
      return done(null, {
        user: req.user
      });
    }
  };

  addRoles = function(context, roles, done) {
    var err;
    err = _validateContext(context);
    if (err) {
      return done(err);
    } else {
      context.user.roles = context.user.roles.concat(roles);
      return done(null, context);
    }
  };

  module.exports = {
    getContext: getContext,
    addRoles: addRoles
  };

}).call(this);
